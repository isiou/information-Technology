# 权限

在 Debian 以及大多数 Linux 系统中，权限管理是一个核心组件，确保了系统的安全性、稳定性和用户之间的隔离。

权限有主要分为文件权限、用户权限、组权限和特殊权限等。

## 文件权限

在目录中，使用 `ls -al` 命令可以让目录内文件以长格式显示，如：

`lrwxrwxrwx   1 root root     8 Jun 15 09:46 sbin -> usr/sbin` 所示。

在此中，`lrwxrwxrwx` 描述文件的类型和权限：

1. 文件类型：

   - `-`：代表这是一个普通文件，包括文本文件、二进制文件、数据文件等。
   - `d`：代表这是一个文件目录。
   - `l`：代表这是一个符号链接，类似 Win 中的快捷方式，在此条目中代表 `sbin` 链接的是 `/usr/sbin`。

2. 文件权限：

   - 读权限 (r) ：允许查看文件内容或目录列表。
   - 写权限 (w) ：允许修改文件内容或在目录中创建、删除、重命名文件。
   - 执行权限 (x) ：允许执行文件（对于文件）或进入目录（对于目录）。

在此中，`1` 表示硬链接计数。对于符号链接，这个数字总是 1，因为符号链接不共享 inode，不计硬链接数。

`root root` 分别表示文件的所有者和所属组，这里都是 root 用户和 root 组。

## 修改文件权限

修改文件的权限通常有以下几种方式：

1. 使用 `chmod` 修改文件权限：

   - 数字模式修改：

     通常情况下，数字模式下权限分为 4、2、1，分别对应读、写、执行。根据一组三位数如 777 代表所有者、同组用户、其他用户都可以读、写、执行此文件。数字 700 代表只有所有者具有全部权限，数字 644 代表所有者可以读和写，同组和其余用户只可以读。

     使用 `chmod 644 filename` 对文件设置权限。

   - 符号模式：

     使用 + 添加权限，- 移除权限，= 设置特定权限。权限字符为 r (读)，w (写)，x (执行)。

     命令格式: `chmod [ugoa][+-=][rwx] filename`

     示例: `chmod u+x,g+w,o-r myfile.txt` 即给所有者添加执行权限，给同组用户添加写权限，移除其他用户的读权限）。

2. 使用 `chown` 修改所有者：

   使用 `chown username filename` 修改该文件的所有者。

3. 使用 `chgrp` 修改所属组：

   使用 `chgrp grpname filename` 修改该文件的所属组。可以指定组名或组 ID。

## 隐藏权限

隐藏权限是系统中一类特殊的文件权限，它们不会在常规的 ls -l 命令输出中显示，主要用于提供比基本读、写、执行权限更细致或额外的访问控制。

这些权限主要用于保护系统的关键文件和目录，防止意外或恶意的修改、删除。主要通过 `chattr` 和 `lsattr` 这两个命令来设置和查看。

常见的隐藏权限包括：

1. i：设置后，文件或目录不能被修改、删除或重命名，即使是 root 用户也不能直接修改其内容或权限，除非先取消这个属性。这可以用来保护重要的系统文件免受意外或恶意修改。

2. a：允许对文件追加内容，但不允许修改或删除现有内容。即使文件的所有者或 root 用户也不能删除文件内容，只能在文件末尾添加数据。这对于日志文件特别有用，可以确保日志的完整性。

使用 `chattr +i/a(-i/a) filename` 对文件设置或取消隐藏权限。

使用 `lsattr filename` 查看文件的隐藏权限。
